-------------------------------------------------------------------------------
### What organization or people are asking to have this signed?
-------------------------------------------------------------------------------
MicroWorld Technologies Inc. - https://www.escanav.com

-------------------------------------------------------------------------------
### What product or service is this for?
-------------------------------------------------------------------------------
eScan for Windows

-------------------------------------------------------------------------------
### What's the justification that this really does need to be signed for the whole world to be able to boot it?
-------------------------------------------------------------------------------
eScan range of Security Solutions are used by millions of customers globally.  It has a feature of rescue-mode, which
allows the user to boot using a linux-bootable and do on-demand malware scanning of drives.
This feature correctly works on legacy systems and on systems with secure-boot disabled.
But, with secure-boot enabled, we need signed shimx64 for booting and scanning.

-------------------------------------------------------------------------------
### Who is the primary contact for security updates, etc.?
-------------------------------------------------------------------------------
- Name:Abhishek
- Position:Developer
- Email address:Abhishekb@escanav.com
- PGP key fingerprint:

(Key should be signed by the other security contacts, pushed to a keyserver
like keyserver.ubuntu.com, and preferably have signatures that are reasonably
well known in the Linux community.)

-----BEGIN PGP PUBLIC KEY BLOCK-----

mQGNBGJ4mscBDADB1NAbNeFQp1URMFI5zAmCrEiuehqHLIe2mqFkC/FTg3iPscNk
w0h7htDA7LDwgjUPUu5W/0fbGKDUwg2jmmovQIfTNtXuelSFrfFPXNrzBU7/qa7v
bIz7lgxPfk4n6T2Y56+HepU8TFHGPjWyu6IWqpiZtDS51UTnop2Pi3fyQJBHrd9t
oCpV/QCSt460AUCNIxnBekoZ17b/NSXBHa39vm/u6laBj6zmp9o9U8b4VwtNXbOk
AGK8aK+X5lFZM6OqUlOlothrBiFHRYzPXpRXGMDRXiYlOJxI52T65Rrelyg3yTmU
1vAkCH5plLCtffb80KuYONmGk9Ojhm4mOjFaf0egSVoMdQKcnpVknV5VZ+DlQso3
PF+KypECxjQsIWocNDnuS/UhuNuTIAaU6NbMmdo4n6IxHHgNcKjzIMLKcq4bfhUM
/XyVV/2vwc6v0Fd3nsIJiaBVHXUXrtFDXqpYDwihNHdTKaC/oB+3HYNEf4seEFlQ
9e4PPwmGJXbCtWUAEQEAAbQgQWJoaXNoZWsgPGFiaGlzaGVrYkBlc2NhbmF2LmNv
bT6JAdcEEwEIAEEWIQRVeKglG66XM7jTHsg9AnvbAfN1EgUCYniaxwIbDwUJC0ny
IQULCQgHAgIiAgYVCgkICwIEFgIDAQIeBwIXgAAKCRA9AnvbAfN1EvYHC/9OGfug
o9DW072OX4fopnnSdvCg80u1cY+rUjgg4GAm2wQhNDujgnF3U2L0uWHsSfFj7HXR
hpS60CGIYUc/CE8qoOaSv7IP5/Yj07yB1rkcnWzv1Egq7LyF4NiH9a1TO+3t95Mu
9MZUY+Ap1s2SWUwt/EOxYsAAA4asG1F1ArmW8Jy2oupfS9VQspQdz3dQtGoWfm8D
y8twGTnRnU22lCn2CnJI0BIVezvupq1hKy6r5EuZmj34t2Opmn744iI2jqhXDeQH
2R7l6o37w5YI0/zpWU+Ge7kBc90dfmD/6aTqEqLzIWMxS3JMkQ3k0fvX/XAwVDoA
eFlaj3rAZd4qdHogvFwqIXTOx34l9YdeuWzpRbaDXihFeKNc7DHCulKW/a5IVqJ6
28I1aiG9GV3Td3YCm5NVPjNYAUPWCF7EfHelRdgM+JZUJlKjF67PnM7Q41RJm2Sk
P/wcKu/21t8n8XVJ9OUwxrGzJ7g0RLQdmlHQwYpAtwR3R7nNEqyUF4SVLdU=
=nRy3
-----END PGP PUBLIC KEY BLOCK-----

PGP Key Fingerprint for identity abhishekb@escanav.com:
5578A8251BAE9733B8D31EC83D027BDB01F37512

-------------------------------------------------------------------------------
### Who is the secondary contact for security updates, etc.?
-------------------------------------------------------------------------------
- Name:Govind Rammurthy
- Position:CTO
- Email address:govind@escanav.com
- PGP key fingerprint:

(Key should be signed by the other security contacts, pushed to a keyserver
like keyserver.ubuntu.com, and preferably have signatures that are reasonably
well known in the Linux community.)

-----BEGIN PGP PUBLIC KEY BLOCK-----

mQGNBGJ4mkMBDADCQsJk9jZya4VuuVXo5hozmBfLJPLQp627QmroucO+rSP5eiHN
15H8UaCshBA1bXV+xh9XM22yLozkJd3aPZr8TFjz6KPH2y+e4W82hj3MOnYeglmM
9V3ZJcpk+2T+Qf9lMJ8QhKus7U8/XU/0v/kkAPcnv5KWoodAwhy/lOtOvbMjR8SO
pcoAqnskpFpC/Z1G0Rqq2qSBr6WIFipmuNBUT16QeKPTI+n0RjZVoqmsf9pPDjuu
EWT4SNjhBdK/aO+s1g/wgbErrvSEM3Ocg1OQ04SX0c3/WyNXqUnrSAxL4/OEgt/n
jSGhbaE5kuOfdBABdfeqfwi+s8W+RtnHJe3k+MAWTuzBogzBYKYRM2JmXVAJX4Dr
rIeOs/JDWeJA+IpKwYIqMPeRNe+2y31iDw+Sz8591YYKr4dsRXtqGd7hompiDl/u
5D94nIaSBYozKnx9VHOjxumahwv0S0f1GnLpwhizFSif+WgJOSAewX3vVTOwtti3
JONBSDNADALhWQEAEQEAAbQlR292aW5kIFJhbW11cnRoeSA8Z292aW5kQGVzY2Fu
YXYuY29tPokB1wQTAQgAQRYhBHYKoFGFeAEpPpyXPmUDJe2+biR4BQJieJpDAhsP
BQkLSfKlBQsJCAcCAiICBhUKCQgLAgQWAgMBAh4HAheAAAoJEGUDJe2+biR4FgcL
/1LPLzJpxSKoQOj5V/pKqFpv7YnYTrQ8ZT7tJvESq+VtaY3KhOSzbl3rCHUMhS3F
KSPHwRfybr6e08hHwtn6TPhOGe6CjgDqxczyP4UZ4agcfXAUVOFlIb3Vgr8Fsf+0
a7coTt2D4MpjgFQyY66sbJMIiCtaKT/a2Tw8lu8GvrD3uaBZuv61nJflsxQMrjA/
2yUjItTf10wrrAl7Uta/VukDeqUEEujTBTTDSc45sS7gF9PP1w+QDjuzgYUpVzoB
TcMBjRMcWZBigJhuhcjZOEa7XuAdF6XEXeASNhbpTp1ya62VfruE9s1FyfZNORp6
vFnd/DdXFvfOLycYyUr4s7n9EArbnxXJPrXn2+coMgzAvfOzeRlDJqhB0XVOySZG
FYcjuIE7NnLFqDq/YernLz3TxdLGbn4U7VT+efQO2a/WoqxrpjEodmFREg6t467X
sCI9U8X9wON9NTVr4rAt4VskFopjWmTjpvFBElNVNPdmHlBjlTSz+T0IxE3vdMcf
uA==
=gp+N
-----END PGP PUBLIC KEY BLOCK-----

PGP Key Fingerprint for identity govind@escanav.com:
760AA051857801293E9C973E650325EDBE6E2478
-------------------------------------------------------------------------------
### Were these binaries created from the 15.5 shim release tar?
Please create your shim binaries starting with the 15.5 shim release tar file: https://github.com/rhboot/shim/releases/download/15.5/shim-15.5.tar.bz2


-------------------------------------------------------------------------------
Yes. We have compiled shim with the latest 15.5, on ubuntu 22.04, with gnu-efi updated.

-------------------------------------------------------------------------------
### URL for a repo that contains the exact code which was built to get this binary:
-------------------------------------------------------------------------------
https://github.com/rhboot/shim.git

-------------------------------------------------------------------------------
### What patches are being applied and why:
-------------------------------------------------------------------------------
None

-------------------------------------------------------------------------------
### If shim is loading GRUB2 bootloader what exact implementation of Secureboot in GRUB2 do you have? (Either Upstream GRUB2 shim_lock verifier or Downstream RHEL/Fedora/Debian/Canonical-like implementation)
-------------------------------------------------------------------------------
Downstream Canonical implementation

-------------------------------------------------------------------------------
### If shim is loading GRUB2 bootloader and your previously released shim booted a version of grub affected by any of the CVEs in the July 2020 grub2 CVE list or the March 2021 grub2 CVE list:
* CVE-2020-14372
* CVE-2020-25632
* CVE-2020-25647
* CVE-2020-27749
* CVE-2020-27779
* CVE-2021-20225
* CVE-2021-20233
* CVE-2020-10713
* CVE-2020-14308
* CVE-2020-14309
* CVE-2020-14310
* CVE-2020-14311
* CVE-2020-15705
* CVE-2021-3418 (if you are shipping the shim_lock module)

### Were old shims hashes provided to Microsoft for verification and to be added to future DBX updates?
### Does your new chain of trust disallow booting old GRUB2 builds affected by the CVEs?
-------------------------------------------------------------------------------
1. All of the above CVE's are addressed, as we are using grub 2.06 (which has these fixes)
2. Old shims were not provided to Microsoft
3. NA

-------------------------------------------------------------------------------
### If your boot chain of trust includes a Linux kernel:
### Is upstream commit [1957a85b0032a81e6482ca4aab883643b8dae06e "efi: Restrict efivar_ssdt_load when the kernel is locked down"](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1957a85b0032a81e6482ca4aab883643b8dae06e) applied?
### Is upstream commit [75b0cea7bf307f362057cc778efe89af4c615354 "ACPI: configfs: Disallow loading ACPI tables when locked down"](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=75b0cea7bf307f362057cc778efe89af4c615354) applied?
-------------------------------------------------------------------------------

Yes, we currently use linux kernel 5.15.10

-------------------------------------------------------------------------------
### If you use vendor_db functionality of providing multiple certificates and/or hashes please briefly describe your certificate setup.
### If there are allow-listed hashes please provide exact binaries for which hashes are created via file sharing service, available in public with anonymous access for verification.
-------------------------------------------------------------------------------
1. vendor_db functionality is not used
2. We are not providing hashes for allow-listing

-------------------------------------------------------------------------------
### If you are re-using a previously used (CA) certificate, you will need to add the hashes of the previous GRUB2 binaries exposed to the CVEs to vendor_dbx in shim in order to prevent GRUB2 from being able to chainload those older GRUB2 binaries. If you are changing to a new (CA) certificate, this does not apply.
### Please describe your strategy.
-------------------------------------------------------------------------------
No previous submission was done.
-------------------------------------------------------------------------------
### What OS and toolchain must we use to reproduce this build?  Include where to find it, etc.  We're going to try to reproduce your build as closely as possible to verify that it's really a build of the source tree you tell us it is, so these need to be fairly thorough. At the very least include the specific versions of gcc, binutils, and gnu-efi which were used, and where to find those binaries.
### If the shim binaries can't be reproduced using the provided Dockerfile, please explain why that's the case and what the differences would be.
-------------------------------------------------------------------------------
We used Ubuntu 22.04 for bulding

Linux 5.15.0-27-generic x86_64
Distributor ID: Ubuntu
Description:    Ubuntu 22.04 LTS
Release:        22.04
Codename:       jammy

Dockerfile to reproduced build:
https://github.com/mwti/shim-review/blob/main/dockerfile.txt

-------------------------------------------------------------------------------
### Which files in this repo are the logs for your build?
This should include logs for creating the buildroots, applying patches, doing the build, creating the archives, etc.

-------------------------------------------------------------------------------
https://github.com/mwti/shim-review/blob/main/makelog.txt

-------------------------------------------------------------------------------
### What changes were made since your SHIM was last signed?
-------------------------------------------------------------------------------
first time submission

-------------------------------------------------------------------------------
### What is the SHA256 hash of your final SHIM binary?
-------------------------------------------------------------------------------
40a1620f6e93a536f10776a93372aa64e4e4b8ca280870a8dac5ad714e685531

-------------------------------------------------------------------------------
### How do you manage and protect the keys used in your SHIM?
-------------------------------------------------------------------------------
It is USB Token based 384-bit EV.   Password for the same is maintained in secure vault file.

-------------------------------------------------------------------------------
### Do you use EV certificates as embedded certificates in the SHIM?
-------------------------------------------------------------------------------
Yes.

-------------------------------------------------------------------------------
### Do you add a vendor-specific SBAT entry to the SBAT section in each binary that supports SBAT metadata ( grub2, fwupd, fwupdate, shim + all child shim binaries )?
### Please provide exact SBAT entries for all SBAT binaries you are booting or planning to boot directly through shim.
### Where your code is only slightly modified from an upstream vendor's, please also preserve their SBAT entries to simplify revocation.
-------------------------------------------------------------------------------
sbat.csv for shim:
https://github.com/mwti/shim-review/blob/main/sbat.csv

sbat,1,SBAT Version,sbat,1,https://github.com/rhboot/shim/blob/main/SBAT.md
shim,1,UEFI shim,shim,1,https://github.com/rhboot/shim
shim.eScanRescue,1,eScan,shim,15.5,https://www.escanav.com


sbat.csv for grub:
https://github.com/mwti/shim-review/blob/main/sbatgrub.csv

sbat,1,SBAT Version,sbat,1,https://github.com/rhboot/shim/blob/main/SBAT.md
grub,1,Free Software Foundation,grub,2.06,https://www.gnu.org/software/grub/
grub.ubuntu,1,Ubuntu,grub2,2.06-2ubuntu7,https://www.ubuntu.com/
grub.eScanRescue,1,eScan,grub2,2.06-2ubuntu7,https://www.escanav.com


-------------------------------------------------------------------------------
### Which modules are built into your signed grub image?
-------------------------------------------------------------------------------
acpi efi{fwsetup,_gop,net,_uga}
all_video bitmap{,_scale} font gfx{menu,term{,_background}} jpeg png video{,_bochs,_cirrus,_colors,_fb}
btrfs ext{2,cmd} fat hfsplus iso9660 lvm mdraid{09,1x} part_{apple,gpt,msdos}
bufio disk{,filter} gzio lvm lzopio mdraid{09,1x} memdisk part_{apple,gpt,msdos} search{,_fs_{file,uuid},_label}
crypto gcry_sha512
chain configfile datetime echo gettext halt keystatus ls{efi{,mmap,systab},sal} loadenv minicmd mmap net normal {password_,}pbkdf2 priority_queue reboot relocator sleep terminal test trig true
linuxefi

-------------------------------------------------------------------------------
### What is the origin and full version number of your bootloader (GRUB or other)?
-------------------------------------------------------------------------------
Grub v2.06

-------------------------------------------------------------------------------
### If your SHIM launches any other components, please provide further details on what is launched.
-------------------------------------------------------------------------------
Shim launches grubx64.efi

-------------------------------------------------------------------------------
### If your GRUB2 launches any other binaries that are not the Linux kernel in SecureBoot mode, please provide further details on what is launched and how it enforces Secureboot lockdown.
-------------------------------------------------------------------------------
Grub2 launches linux kernel only.

-------------------------------------------------------------------------------
### How do the launched components prevent execution of unauthenticated code?
-------------------------------------------------------------------------------
Signed Shim will launch signed grubx64
Signed grubx64 will launch signed kernel (vmlinuz64)
vmlinuz64 is based on kernel 5.15.10
So all known vulnerabilities are patched. Plus binaries are signed with EV-Cert to ensure secure boot.

-------------------------------------------------------------------------------
### Does your SHIM load any loaders that support loading unsigned kernels (e.g. GRUB)?
-------------------------------------------------------------------------------
No.

-------------------------------------------------------------------------------
### What kernel are you using? Which patches does it includes to enforce Secure Boot?
-------------------------------------------------------------------------------
We are using  kernel version 5.15.10

-------------------------------------------------------------------------------
### Add any additional information you think we may need to validate this shim.
-------------------------------------------------------------------------------
None
